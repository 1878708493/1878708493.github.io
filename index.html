<!DOCTYPE html>

<html><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Pragma" content="no-cache">
	<meta charset="UTF-8">

	<title>宝宝和白痴的纪念册</title>
	<link rel="stylesheet" href="./jscss/min.css">
	<script src="./jscss/share.js"></script>
	    
		<link type="text/css" rel="stylesheet" href="./Love_files/default.css">
        <script type="text/javascript" src="./Love_files/jquery.min.js"></script>
        <script type="text/javascript" src="./Love_files/jscex.min.js"></script>
        <script type="text/javascript" src="./Love_files/jscex-parser.js"></script>
        <script type="text/javascript" src="./Love_files/jscex-jit.js"></script>
        <script type="text/javascript" src="./Love_files/jscex-builderbase.min.js"></script>
        <script type="text/javascript" src="./Love_files/jscex-async.min.js"></script>
        <script type="text/javascript" src="./Love_files/jscex-async-powerpack.min.js"></script>
        <script type="text/javascript" src="./Love_files/functions.js" charset="utf-8"></script>
        <script type="text/javascript" src="./Love_files/love.js" charset="utf-8"></script>
		
	<link href="lastPage_files/css/default.css" type="text/css" rel="stylesheet">
	<link rel="stylesheet" href="lastPage_files/css/jquery.fullPage.css">
	<link href="lastPage_files/css/slider-wb.css" rel="stylesheet">
	<script type="text/javascript" src="lastPage_files/js/functions.js"></script>
	<script type="text/javascript" src="lastPage_files/js/ge1doot.js"></script>
	<script type="text/javascript" src="lastPage_files/js/jquery.fullPage.js"></script>
	
	<style>

        html
        {
            overflow:visible;
            -ms-touch-action: none;
            -ms-content-zooming: none;
        }
		
		body
        {
            position: absolute;
            margin: 0px;
            padding: 0px;
            background: #fff;
            width: 100%;
            height: 100%;
        }
        #canvas
        {
            position: relative;
            width: 100%;
            height: 100%;
            background: #fff;
        }
				
		.say{
			margin-left:5px;
			font-size:14px;
			font-family:'微软雅黑','宋体',sans-serif;
			color:#231F20;
		}
</style>


	
</head>
	
	
	
<body class="ft-absolute-nav">
	<div class="flowtime" style="transform: translateX(-500%) translateY(0%);">
		<div class="ft-section section-1" data-id="__section-1" data-prog="__1" id="">
			<div id="" class="ft-page page-1 past-section" data-id="__page-1" data-prog="__1">
				<div id="error">亲，您使用的浏览器无法支持即将显示的内容，请换成谷歌(<a href="http://www.google.cn/chrome/intl/zh-CN/landing_chrome.html?hl=zh-CN&brand=CHMI">Chrome</a>)或者火狐(<a href="http://firefox.com.cn/download/">Firefox</a>)浏览器哟~</div>
				<div id="wrap">
				   <div id="text">
						<div id="code">                 
						<span class="say">我的宝宝，</span><br>
						<span class="say">其实我说出特长来做礼物的时候。</span><br>
						<span class="say">我也不确定到底要做个什么。</span><br>
						<span class="say">想了想，我们一起经历了这么多，</span><br>
						 <span class="say">还是一本完整的纪念册，如果能够伴随我们一直到老，</span><br>
						<span class="say">我就做一个网站，我来维护，</span><br>
						<span class="say">记录我们的喜怒哀乐，记录我们生活中的事</span><br>
						<span class="say">里面的有一些时间，已经记不清了。</span><br>
						<span class="say">但是所有幸福的事情，我都牢牢记得。</span><br>
						<span class="say">我期待这一生与你一起走过，</span><br>
						<span class="say">我期待与你慢慢变老</span><br>
						<span class="say">等我们老到哪儿也去不了，</span><br>
						<span class="say">这里还能满载着一生的幸福快乐 ！</span><br>
						<br>
						<span class="say">我会一直更新下去，只要我们都安好。</span><br>
						 <span class="say">我会为我们以后的生活负责，</span><br>
						  <span class="say">我愿意为你去做每一件能让你开心快乐的事。</span><br>
						   <span class="say">所有我们经历的点点滴滴，</span><br>
							<span class="say">都是我们一辈子最美的回忆。</span><br>
							 <span class="say">我愿意爱你直到老去！</span><br>
					   <br>
					   <span class="say">亲爱的，情人节快乐！</span><br>
						<span class="say">现在，按着下箭头，我们一起来看看我们的回忆吧</span><br>
						
						<br>
						<span class="say"><span class="space"></span> -- 爱你的宁 2018.02.14</span>
						</div>
					</div>
					<canvas id="canvas1" width="1100" height="680"></canvas>
				</div>
			</div>
			<div id="" class="ft-page page-2 past-section future-page" data-id="__page-2" data-prog="__2">
			
				<img src="./jscss/幻灯片1.jpg" >
			</div>
			<div id="" class="ft-page page-3 left-img past-section future-page" data-id="__page-3" data-prog="__3">
				
				<img src="./jscss/幻灯片2.jpg" >
			</div>
			<div id="" class="ft-page page-4 full-img past-section future-page" data-id="__page-4" data-prog="__4">
				
				<img src="./jscss/幻灯片3.jpg" >
			</div>
		</div>
		<div class="ft-section section-2" data-id="__section-2" data-prog="__2" id="">
			<div id="" class="ft-page page-5 full-img past-section" data-id="__page-1" data-prog="__1">
			
				<img src="./jscss/幻灯片4.jpg">
			</div>
			<div id="" class="ft-page page-6 past-section future-page" data-id="__page-2" data-prog="__2">
				
				<img src="./jscss/幻灯片5.jpg">
			</div>
			<div id="" class="ft-page page-7 past-section future-page" data-id="__page-3" data-prog="__3">
				
				<img src="./jscss/幻灯片6.jpg">
			</div>
			<div id="" class="ft-page page-8 full-img past-section future-page" data-id="__page-4" data-prog="__4">
				
				<img src="./jscss/幻灯片7.jpg">
			</div>
			<div id="" class="ft-page page-9 past-section future-page" data-id="__page-5" data-prog="__5">
				
				<img src="./jscss/幻灯片8.jpg">
			</div>
			<div id="" class="ft-page page-10 past-section future-page" data-id="__page-6" data-prog="__6">
			
				<img src="./jscss/幻灯片9.jpg" alt="并且面带阳光、自信的笑容">
			</div>
		</div>
		<div class="ft-section section-3" data-id="__section-3" data-prog="__3" id="">
			<div id="" class="ft-page page-11 full-img past-section" data-id="__page-1" data-prog="__1">
				
				<img src="./jscss/幻灯片10.jpg" alt="生活也不会总是一帆风顺">
			</div>
			<div id="" class="ft-page page-12 past-section future-page" data-id="__page-2" data-prog="__2">
				<img src="./jscss/幻灯片11.jpg" alt="但他每次都能勇敢的面对">
			</div>
			<div id="" class="ft-page page-13 past-section future-page" data-id="__page-3" data-prog="__3">
				<img src="./jscss/幻灯片12.jpg" alt="可是小明的爱情又在哪里呢？">
				
			</div>
			<div id="" class="ft-page page-14 left-img past-section future-page" data-id="__page-4" data-prog="__4">
		
				<img src="./jscss/幻灯片13.jpg" alt="在镜子里面吗？他不敢相信">
			</div>
			<div id="" class="ft-page page-15 left-img past-section future-page" data-id="__page-5" data-prog="__5">
				
				<img src="./jscss/幻灯片14.jpg" alt="他去问大树，我的爱情在哪里？">
			</div>
			<div id="" class="ft-page page-16 left-img past-section future-page" data-id="__page-6" data-prog="__6">
			
				<img src="./jscss/幻灯片16.jpg" alt="于是，小明一个人继续向前走">
			</div>
			
		</div>
		<div class="ft-section section-4" data-id="__section-4" data-prog="__4" id="">
			<div id="" class="ft-page page-18 full-img past-section" data-id="__page-1" data-prog="__1">
				<img src="./jscss/幻灯片17.jpg">
			</div>
			<div id="" class="ft-page page-19 past-section future-page" data-id="__page-2" data-prog="__2">
				<img src="./jscss/幻灯片18.jpg">
			</div>
			<div id="" class="ft-page page-20 past-section future-page" data-id="__page-3" data-prog="__3">
				<img src="./jscss/幻灯片19.jpg">
			</div>
			<div id="" class="ft-page page-21 past-section future-page" data-id="__page-4" data-prog="__4">
				<img src="./jscss/幻灯片20.jpg">
			</div>
			<div id="" class="ft-page page-22 left-img past-section future-page" data-id="__page-5" data-prog="__5">
				<img src="./jscss/幻灯片21.jpg">
			</div>
			<div id="" class="ft-page page-23 left-img past-section future-page" data-id="__page-6" data-prog="__6">
				<img src="./jscss/幻灯片22.jpg">
			</div>
			<div id="" class="ft-page page-24 full-img past-section future-page" data-id="__page-7" data-prog="__7">	
				<img src="./jscss/幻灯片23.jpg">
			</div>
		</div>
		<div class="ft-section section-5" data-id="__section-5" data-prog="__5" id="">
			<div id="" class="ft-page page-25 left-img past-section" data-id="__page-1" data-prog="__1">
				<img src="./jscss/幻灯片24.jpg">
			</div>
			<div id="" class="ft-page page-26 top-text past-section future-page" data-id="__page-2" data-prog="__2">
				<img src="./jscss/幻灯片25.jpg">
			</div>
			<div id="" class="ft-page page-27 past-section future-page" data-id="__page-3" data-prog="__3">
				<img src="./jscss/幻灯片26.jpg">
			</div>
			<div id="" class="ft-page page-28 past-section future-page" data-id="__page-4" data-prog="__4">
				<img src="./jscss/幻灯片27.jpg">
			</div>
			<div id="" class="ft-page page-29 past-section future-page" data-id="__page-5" data-prog="__5">
				<img src="./jscss/幻灯片28.jpg">
			</div>
			<div id="" class="ft-page page-30 past-section future-page" data-id="__page-6" data-prog="__6">
				<img src="./jscss/幻灯片29.jpg">
			</div>
			<div id="" class="ft-page page-31 past-section future-page" data-id="__page-7" data-prog="__7">
				<img src="./jscss/幻灯片30.jpg">
			</div>
		</div>
		<div class="ft-section section-6" data-id="__section-6" data-prog="__6" id="">
			<div id="" class="ft-page page-32 hilite actual" data-id="__page-1" data-prog="__1">
				<img src="./jscss/幻灯片31.jpg">
			</div>
			<div id="" class="ft-page page-33 top-text future-page" data-id="__page-2" data-prog="__2">
				<img src="./jscss/幻灯片32.jpg">
			</div>
			<div id="" class="ft-page page-34 left-img future-page" data-id="__page-3" data-prog="__3">
				<img src="./jscss/幻灯片33.jpg">
			</div>
			<div id="" class="ft-page page-35 future-page" data-id="__page-4" data-prog="__4">
				<img src="./jscss/幻灯片34.jpg">
			</div>
			<div id="" class="ft-page page-36 full-img future-page" data-id="__page-5" data-prog="__5">
				<img src="./jscss/幻灯片35.jpg">
			</div>
			<div id="" class="ft-page page-37 left-img future-page" data-id="__page-6" data-prog="__6">
				<img src="./jscss/幻灯片36.jpg">
			</div>
			<div id="" class="ft-page page-38 bottom-text future-page" data-id="__page-7" data-prog="__7">
				<img src="./jscss/幻灯片37.jpg">
			</div>
		</div>
		<div class="ft-section section-7" data-id="__section-7" data-prog="__7" id="">
			<div id="" class="ft-page page-39 left-img future-section" data-id="__page-1" data-prog="__1">
				<img src="./jscss/幻灯片38.jpg">
			</div>
			<div id="" class="ft-page page-40 future-section future-page" data-id="__page-2" data-prog="__2">
				<img src="./jscss/幻灯片39.jpg">
			</div>
			<div id="" class="ft-page page-41 future-section future-page" data-id="__page-3" data-prog="__3">
				<p class="text">
					我们的画廊
				</p>	
				<canvas id="canvas"></canvas>
			</div>
			<div id="" class="ft-page page-42 future-section future-page" data-id="__page-4" data-prog="__4">

			</div>
			<div id="" class="ft-page page-43 future-section future-page" data-id="__page-5" data-prog="__5">

			</div>
			<div id="" class="ft-page page-44 left-img future-section future-page" data-id="__page-6" data-prog="__6">

			</div>
			<div id="" class="ft-page page-45 left-img future-section future-page" data-id="__page-7" data-prog="__7">

			</div>
		</div>
		<div class="ft-section section-8" data-id="__section-8" data-prog="__8" id="">
			<div id="" class="ft-page page-46 future-section" data-id="__page-1" data-prog="__1">

			</div>
			<div id="" class="ft-page page-47 top-text future-section future-page" data-id="__page-2" data-prog="__2">

			</div>
			<div id="" class="ft-page page-48 left-img future-section future-page" data-id="__page-3" data-prog="__3">

			</div>
			<div id="" class="ft-page page-49 full-img future-section future-page" data-id="__page-4" data-prog="__4">

			</div>
			<div id="" class="ft-page page-50 future-section future-page" data-id="__page-5" data-prog="__5">

			</div>
			<div id="" class="ft-page page-51 future-section future-page" data-id="__page-6" data-prog="__6">

			</div>
		</div>
		<div class="ft-section section-9" data-id="__section-9" data-prog="__9" id="">
			<div id="" class="ft-page page-52 full-img future-section" data-id="__page-1" data-prog="__1">

			</div>
			<div id="" class="ft-page page-53 future-section future-page" data-id="__page-2" data-prog="__2">

			</div>
			<div id="" class="ft-page page-54 center-img future-section future-page" data-id="__page-3" data-prog="__3">
				   
			</div>
			<div id="" class="ft-page page-55 right-img future-section future-page" data-id="__page-4" data-prog="__4">
			
			</div>
		</div>
	</div>
	
	
	
    <audio id="bgmMusic" src="./jscss/等你下课.mp3" preload="auto" type="audio/mp3" autoplay="" loop=""></audio>
	
	<script src="./jscss/jquery.min.js"></script>
	<script src="./jscss/all.min.js"></script>
	<script src="./jscss/love.js"></script><div class="ft-default-progress"><div data-section="__0" class="ft-section-thumb thumb-section-0"><div class="ft-page-thumb thumb-page-0" data-section="__0" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__0" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__0" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__0" data-page="__3"></div></div><div data-section="__1" class="ft-section-thumb thumb-section-1"><div class="ft-page-thumb thumb-page-0" data-section="__1" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__1" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__1" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__1" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__1" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__1" data-page="__5"></div></div><div data-section="__2" class="ft-section-thumb thumb-section-2"><div class="ft-page-thumb thumb-page-0" data-section="__2" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__2" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__2" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__2" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__2" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__2" data-page="__5"></div><div class="ft-page-thumb thumb-page-6" data-section="__2" data-page="__6"></div></div><div data-section="__3" class="ft-section-thumb thumb-section-3"><div class="ft-page-thumb thumb-page-0" data-section="__3" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__3" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__3" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__3" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__3" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__3" data-page="__5"></div><div class="ft-page-thumb thumb-page-6" data-section="__3" data-page="__6"></div></div><div data-section="__4" class="ft-section-thumb thumb-section-4"><div class="ft-page-thumb thumb-page-0" data-section="__4" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__4" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__4" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__4" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__4" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__4" data-page="__5"></div><div class="ft-page-thumb thumb-page-6" data-section="__4" data-page="__6"></div></div><div data-section="__5" class="ft-section-thumb thumb-section-5"><div class="ft-page-thumb thumb-page-0 actual" data-section="__5" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__5" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__5" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__5" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__5" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__5" data-page="__5"></div><div class="ft-page-thumb thumb-page-6" data-section="__5" data-page="__6"></div></div><div data-section="__6" class="ft-section-thumb thumb-section-6"><div class="ft-page-thumb thumb-page-0" data-section="__6" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__6" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__6" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__6" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__6" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__6" data-page="__5"></div><div class="ft-page-thumb thumb-page-6" data-section="__6" data-page="__6"></div></div><div data-section="__7" class="ft-section-thumb thumb-section-7"><div class="ft-page-thumb thumb-page-0" data-section="__7" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__7" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__7" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__7" data-page="__3"></div><div class="ft-page-thumb thumb-page-4" data-section="__7" data-page="__4"></div><div class="ft-page-thumb thumb-page-5" data-section="__7" data-page="__5"></div></div><div data-section="__8" class="ft-section-thumb thumb-section-8"><div class="ft-page-thumb thumb-page-0" data-section="__8" data-page="__0"></div><div class="ft-page-thumb thumb-page-1" data-section="__8" data-page="__1"></div><div class="ft-page-thumb thumb-page-2" data-section="__8" data-page="__2"></div><div class="ft-page-thumb thumb-page-3" data-section="__8" data-page="__3"></div></div></div>
    <div class="mPower"><span id="on" title="点击暂停"></span><span id="off" title="点击播放"></span></div>

	
	<script>
    (function(){
        var canvas = $('#canvas1');

        if (!canvas[0].getContext) {
            $("#error").show();
            return false;
        }

        var width = canvas.width();
        var height = canvas.height();
        
        canvas.attr("width", width);
        canvas.attr("height", height);

        var opts = {
            seed: {
                x: width / 2 - 20,
                color: "rgb(190, 26, 37)",
                scale: 2
            },
            branch: [
                [535, 680, 570, 250, 500, 200, 30, 100, [
                    [540, 500, 455, 417, 340, 400, 13, 100, [
                        [450, 435, 434, 430, 394, 395, 2, 40]
                    ]],
                    [550, 445, 600, 356, 680, 345, 12, 100, [
                        [578, 400, 648, 409, 661, 426, 3, 80]
                    ]],
                    [539, 281, 537, 248, 534, 217, 3, 40],
                    [546, 397, 413, 247, 328, 244, 9, 80, [
                        [427, 286, 383, 253, 371, 205, 2, 40],
                        [498, 345, 435, 315, 395, 330, 4, 60]
                    ]],
                    [546, 357, 608, 252, 678, 221, 6, 100, [
                        [590, 293, 646, 277, 648, 271, 2, 80]
                    ]]
                ]] 
            ],
            bloom: {
                num: 700,
                width: 1080,
                height: 650,
            },
            footer: {
                width: 1200,
                height: 5,
                speed: 10,
            }
        }

        var tree = new Tree(canvas[0], width, height, opts);
        var seed = tree.seed;
        var foot = tree.footer;
        var hold = 1;

        canvas.click(function(e) {
            var offset = canvas.offset(), x, y;
            x = e.pageX - offset.left;
            y = e.pageY - offset.top;
            if (seed.hover(x, y)) {
                hold = 0; 
                canvas.unbind("click");
                canvas.unbind("mousemove");
                canvas.removeClass('hand');
            }
        }).mousemove(function(e){
            var offset = canvas.offset(), x, y;
            x = e.pageX - offset.left;
            y = e.pageY - offset.top;
            canvas.toggleClass('hand', seed.hover(x, y));
        });

        var seedAnimate = eval(Jscex.compile("async", function () {
            seed.draw();
            while (hold) {
                $await(Jscex.Async.sleep(10));
            }
            while (seed.canScale()) {
                seed.scale(0.95);
                $await(Jscex.Async.sleep(10));
            }
            while (seed.canMove()) {
                seed.move(0, 2);
                foot.draw();
                $await(Jscex.Async.sleep(10));
            }
        }));

        var growAnimate = eval(Jscex.compile("async", function () {
            do {
                tree.grow();
                $await(Jscex.Async.sleep(10));
            } while (tree.canGrow());
        }));

        var flowAnimate = eval(Jscex.compile("async", function () {
            do {
                tree.flower(2);
                $await(Jscex.Async.sleep(10));
            } while (tree.canFlower());
        }));

        var moveAnimate = eval(Jscex.compile("async", function () {
            tree.snapshot("p1", 240, 0, 610, 680);
            while (tree.move("p1", 500, 0)) {
                foot.draw();
                $await(Jscex.Async.sleep(10));
            }
            foot.draw();
            tree.snapshot("p2", 500, 0, 610, 680);

            // 会有闪烁不得意这样做, (＞﹏＜)
            canvas.parent().css("background", "url(" + tree.toDataURL('image/png') + ")");
            canvas.css("background", "#ffe");
            $await(Jscex.Async.sleep(300));
            canvas.css("background", "none");
        }));

        var jumpAnimate = eval(Jscex.compile("async", function () {
            var ctx = tree.ctx;
            while (true) {
                tree.ctx.clearRect(0, 0, width, height);
                tree.jump();
                foot.draw();
                $await(Jscex.Async.sleep(25));
            }
        }));

        var textAnimate = eval(Jscex.compile("async", function () {
            var together = new Date();
            together.setFullYear(2010, 5, 8);
            together.setHours(20);
            together.setMinutes(20);
            together.setSeconds(0);
            together.setMilliseconds(0);

            $("#code").show().typewriter();
            $("#clock-box").fadeIn(500);
            while (true) {
                timeElapse(together);
                $await(Jscex.Async.sleep(1000));
            }
        }));

        var runAsync = eval(Jscex.compile("async", function () {
            $await(seedAnimate());
            $await(growAnimate());
            $await(flowAnimate());
            $await(moveAnimate());

            textAnimate().start();

            $await(jumpAnimate());
        }));

        runAsync().start();
    })();
    </script>
	
	
	<script type="text/javascript">
        "use strict";

        (function () {
            /* ==== definitions ==== */
            var diapo = [], layers = [], ctx, pointer, scr, camera, light, fps = 0, quality = [1, 2],
			
            // ---- poly constructor ----
			Poly = function (parent, face) {
				this.parent = parent;
				this.ctx = ctx;
				this.color = face.fill || false;
				this.points = [];
				if (!face.img) {
					// ---- create points ----
					for (var i = 0; i < 4; i++) {
						this.points[i] = new ge1doot.transform3D.Point(
							parent.pc.x + (face.x[i] * parent.normalZ) + (face.z[i] * parent.normalX),
							parent.pc.y + face.y[i],
							parent.pc.z + (face.x[i] * parent.normalX) + (-face.z[i] * parent.normalZ)
						);
					}
					this.points[3].next = false;
				}
			},
			
            // ---- diapo constructor ----
			Diapo = function (path, img, structure) {
				// ---- create image ----
				this.img = new ge1doot.transform3D.Image(
					this, path + img.img, 1, {
						isLoaded: function (img) {
							img.parent.isLoaded = true;
							img.parent.loaded(img);
						}
					}
				);
				this.visible = false;
				this.normalX = img.nx;
				this.normalZ = img.nz;
				// ---- point center ----
				this.pc = new ge1doot.transform3D.Point(img.x, img.y, img.z);
				// ---- target positions ----
				this.tx = img.x + (img.nx * Math.sqrt(camera.focalLength) * 20);
				this.tz = img.z - (img.nz * Math.sqrt(camera.focalLength) * 20);
				// ---- create polygons ----
				this.poly = [];
				for (var i = -1, p; p = structure[++i]; ) {
					layers[i] = (p.img === true ? 1 : 2);
					this.poly.push(
						new Poly(this, p)
					);
				}
			},
			
            // ---- init section ----
			init = function (json) {
				// draw poly primitive
				Poly.prototype.drawPoly = ge1doot.transform3D.drawPoly;
				// ---- init screen ----
				scr = new ge1doot.Screen({
					container: "canvas"
				});
				ctx = scr.ctx;
				scr.resize();
				// ---- init pointer ----
				pointer = new ge1doot.Pointer({
					tap: function () {
						if (camera.over) {
							if (camera.over === camera.target.elem) {
								// ---- return to the center ----
								camera.target.x = 0;
								camera.target.z = 0;
								camera.target.elem = false;
							} else {
								// ---- goto diapo ----
								camera.target.elem = camera.over;
								camera.target.x = camera.over.tx;
								camera.target.z = camera.over.tz;
								// ---- adapt tesselation level to distance ----
								for (var i = 0, d; d = diapo[i++]; ) {
									var dx = camera.target.x - d.pc.x;
									var dz = camera.target.z - d.pc.z;
									var dist = Math.sqrt(dx * dx + dz * dz);
									var lev = (dist > 1500) ? quality[0] : quality[1];
									d.img.setLevel(lev);
								}
							}
						}
					}
				});
				// ---- init camera ----
				camera = new ge1doot.transform3D.Camera({
					focalLength: Math.sqrt(scr.width) * 10,
					easeTranslation: 0.025,
					easeRotation: 0.06,
					disableRz: true
				}, {
					move: function () {
						this.over = false;
						// ---- rotation ----
						if (pointer.isDraging) {
							this.target.elem = false;
							this.target.ry = -pointer.Xi * 0.01;
							this.target.rx = (pointer.Y - scr.height * 0.5) / (scr.height * 0.5);
						} else {
							if (this.target.elem) {
								this.target.ry = Math.atan2(
									this.target.elem.pc.x - this.x,
									this.target.elem.pc.z - this.z
								);
							}
						}
						this.target.rx *= 0.9;
					}
				});
				camera.z = -10000;
				camera.py = 0;
				// ---- create images ----
				for (var i = 0, img; img = json.imgdata[i++]; ) {
					diapo.push(
						new Diapo(
							json.options.imagesPath,
							img,
							json.structure
						)
					);
				}
				// ---- start engine ---- >>>
				setInterval(function () {
					quality = (fps > 50) ? [2, 3] : [1, 2];
					fps = 0;
				}, 1000);
				run();
			},
			
            // ---- main loop ----
			run = function () {
				// ---- clear screen ----
				ctx.clearRect(0, 0, scr.width, scr.height);
				// ---- camera ----
				camera.move();
				// ---- draw layers ----
				for (var k = -1, l; l = layers[++k]; ) {
					light = false;
					for (var i = 0, d; d = diapo[i++]; ) {
						(l === 1 && d.draw()) ||
						(d.visible && d.poly[k].draw());
					}
				}
				// ---- cursor ----
				if (camera.over && !pointer.isDraging) {
					scr.setCursor("pointer");
				} else {
					scr.setCursor("move");
				}
				// ---- loop ----
				fps++;
				requestAnimFrame(run);
			};
			
            /* ==== prototypes ==== */
            Poly.prototype.draw = function () {
                // ---- color light ----
                var c = this.color;
                if (c.light || !light) {
                    var s = c.light ? this.parent.light : 1;
                    // ---- rgba color ----
                    light = "rgba(" +
					Math.round(c.r * s) + "," +
					Math.round(c.g * s) + "," +
					Math.round(c.b * s) + "," + (c.a || 1) + ")";
                    ctx.fillStyle = light;
                }
                // ---- paint poly ----
                if (!c.light || this.parent.light < 1) {
                    // ---- projection ----
                    for (
						var i = 0;
						this.points[i++].projection();
					);
                    this.drawPoly();
                    ctx.fill();
                }
            }
			
            /* ==== image onload ==== */
            Diapo.prototype.loaded = function (img) {
                // ---- create points ----
                var d = [-1, 1, 1, -1, 1, 1, -1, -1];
                var w = img.texture.width * 0.5;
                var h = img.texture.height * 0.5;
                for (var i = 0; i < 4; i++) {
                    img.points[i] = new ge1doot.transform3D.Point(
						this.pc.x + (w * this.normalZ * d[i]),
						this.pc.y + (h * d[i + 4]),
						this.pc.z + (w * this.normalX * d[i])
					);
                }
            }
			
            /* ==== images draw ==== */
            Diapo.prototype.draw = function () {
                // ---- visibility ----
                this.pc.projection();
                if (this.pc.Z > -(camera.focalLength >> 1) && this.img.transform3D(true)) {
                    // ---- light ----
                    this.light = 0.5 + Math.abs(this.normalZ * camera.cosY - this.normalX * camera.sinY) * 0.6;
                    // ---- draw image ----
                    this.visible = true;
                    this.img.draw();
                    // ---- test pointer inside ----
                    if (pointer.hasMoved || pointer.isDown) {
                        if (
							this.img.isPointerInside(
								pointer.X,
								pointer.Y
							)
						)
						camera.over = this;
					}
                } 
				else 
					this.visible = false;
					
                return true;
            }
            return {
                // --- load data ----
                load: function (data) {
                    window.addEventListener('load', function () {
                        ge1doot.loadJS(
							"lastPage_files/js/imageTransform3D.js",
							init, data
						);
                    }, false);
                }
            }
        })().load({
            imgdata: [
				// north
				{img: 'lastPage_files/imgs/1.jpg', x: -1000, y: 0, z: 1500, nx: 0, nz: 1 },
				{ img: 'lastPage_files/imgs/2.jpg', x: 0, y: 0, z: 1500, nx: 0, nz: 1 },
				{ img: 'lastPage_files/imgs/3.jpg', x: 1000, y: 0, z: 1500, nx: 0, nz: 1 },
					// east
				{img: 'lastPage_files/imgs/4.jpg', x: 1500, y: 0, z: 1000, nx: -1, nz: 0 },
				{ img: 'lastPage_files/imgs/5.jpg', x: 1500, y: 0, z: 0, nx: -1, nz: 0 },
				{ img: 'lastPage_files/imgs/6.jpg', x: 1500, y: 0, z: -1000, nx: -1, nz: 0 },
					// south
				{img: 'lastPage_files/imgs/7.jpg', x: 1000, y: 0, z: -1500, nx: 0, nz: -1 },
				{ img: 'lastPage_files/imgs/8.jpg', x: 0, y: 0, z: -1500, nx: 0, nz: -1 },
				{ img: 'lastPage_files/imgs/9.jpg', x: -1000, y: 0, z: -1500, nx: 0, nz: -1 },
					// west
				{img: 'lastPage_files/imgs/10.jpg', x: -1500, y: 0, z: -1000, nx: 1, nz: 0 },
				{ img: 'lastPage_files/imgs/11.jpg', x: -1500, y: 0, z: 0, nx: 1, nz: 0 },
				{ img: 'lastPage_files/imgs/12.jpg', x: -1500, y: 0, z: 1000, nx: 1, nz: 0 }
			],
            structure: [
				{
					// wall
					fill: { r: 255, g: 255, b: 255, light: 1 },
					x: [-1001, -490, -490, -1001],
					z: [-500, -500, -500, -500],
					y: [500, 500, -500, -500]
				}, {
					// wall
					fill: { r: 255, g: 255, b: 255, light: 1 },
					x: [-501, 2, 2, -500],
					z: [-500, -500, -500, -500],
					y: [500, 500, -500, -500]
				}, {
					// wall
					fill: { r: 255, g: 255, b: 255, light: 1 },
					x: [0, 502, 502, 0],
					z: [-500, -500, -500, -500],
					y: [500, 500, -500, -500]
				}, {
					// wall
					fill: { r: 255, g: 255, b: 255, light: 1 },
					x: [490, 1002, 1002, 490],
					z: [-500, -500, -500, -500],
					y: [500, 500, -500, -500]
				}, {
					// shadow
					fill: { r: 0, g: 0, b: 0, a: 0.2 },
					x: [-420, 420, 420, -420],
					z: [-500, -500, -500, -500],
					y: [150, 150, -320, -320]
				}, {
					// shadow
					fill: { r: 0, g: 0, b: 0, a: 0.2 },
					x: [-20, 20, 20, -20],
					z: [-500, -500, -500, -500],
					y: [250, 250, 150, 150]
				}, {
					// shadow
					fill: { r: 0, g: 0, b: 0, a: 0.2 },
					x: [-20, 20, 20, -20],
					z: [-500, -500, -500, -500],
					y: [-320, -320, -500, -500]
				}, {
					// shadow
					fill: { r: 0, g: 0, b: 0, a: 0.2 },
					x: [-20, 20, 10, -10],
					z: [-500, -500, -100, -100],
					y: [-500, -500, -500, -500]
				}, {
					// base
					fill: { r: 32, g: 32, b: 32 },
					x: [-50, 50, 50, -50],
					z: [-150, -150, -50, -50],
					y: [-500, -500, -500, -500]
				}, {
					// support
					fill: { r: 16, g: 16, b: 16 },
					x: [-10, 10, 10, -10],
					z: [-100, -100, -100, -100],
					y: [300, 300, -500, -500]
				}, {
					// frame
					fill: { r: 255, g: 255, b: 255 },
					x: [-320, -320, -320, -320],
					z: [0, -20, -20, 0],
					y: [-190, -190, 190, 190]
				}, {
					// frame
					fill: { r: 255, g: 255, b: 255 },
					x: [320, 320, 320, 320],
					z: [0, -20, -20, 0],
					y: [-190, -190, 190, 190]
				},
				{ img: true },
				{
					// ceilingLight
					fill: { r: 255, g: 128, b: 0 },
					x: [-50, 50, 50, -50],
					z: [450, 450, 550, 550],
					y: [500, 500, 500, 500]
				}, 
				{
					// groundLight
					fill: { r: 255, g: 128, b: 0 },
					x: [-50, 50, 50, -50],
					z: [450, 450, 550, 550],
					y: [-500, -500, -500, -500]
				}
			],
            options: {
                imagesPath: ""
            }
        });
</script>
	
</body></html>